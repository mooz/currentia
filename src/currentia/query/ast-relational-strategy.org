AST から関係代数への変換

AST から関係代数への変換をそろそろ実装しないと形無しなので，真面目にス
テップ分けして取り組んでいくよ．

* AST の作成

問題点は次のことぐらいか

- 非均質か均質か

* AST validator

AST を解釈して，そのクエリが正しいかどうかをチェックする処理．

「正しくない」ものの例．

- 存在しないストリーム名，属性名の参照など，カタログ情報と照らし合せる
  ことで判明する問題

- 

* AST simplifier

AST をシンプルにする．

条件式がこれにより CNF へ正規化される．他にも定数式の計算など，色々とシ
ンプルにすることができそう．myui さんのツイートを見直すか．

* AST -> Relational

AST から関係代数への変換．

簡単なものなら，気合で何とかなりそう．複雑な条件式の割り当てをどうする
かが問題．

** TODO 複雑条件式をリレーションのペア毎に分離

つまり，次のような条件式を，

- =(A.X > B.Y) && (B.Y > C.X) && (A.Z > B.Z) && (B.Y > D.X)=

次の 3 ペアに分離する．

- =(A.X > B.Y) && (A.Z > B.Z)=

- =(B.Y > C.X)=

- =(B.Y > D.X)=

*** 手順

手順を以下に．

- まず条件式を操作して出現する全てのリレーションを把握する

- 出現しうるリレーション名から取り出された 2 リレーションの組み合わせに
  ついて，条件を抜き出す

*** 条件式のインタフェース

条件式側にあると良いものとしては，

- AND で区切られ，それぞれを簡単に切り離すことを前提とした構造

- 条件式に 2 つのリレーション名 (ID) を渡すと，その 2 リレーションに関
  する条件式なのかを判別する述語関数

などだろうか．
